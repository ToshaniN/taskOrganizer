<body>
    <h1>Task Organizer</h1>
    <ul>
        <!--For each agenda-->
        <li *ngFor="let agenda of todoList;let in = index;">
            <div id="agendaHeader">
                <h2 id="AName">
                    <input [(ngModel)]="agenda.name">
                    <!-- {{ agenda.name }} -->
                </h2> 
                <h3 id="AStatus"> Status: 
                    <select [(ngModel)]="agenda.status">
                        <option *ngFor="let status of agendaStatusOptions">{{ status.name }}</option>
                    </select>
                    <!-- {{ agenda.status }} -->
                </h3> 
            </div>
            <h3 id="tasksHeading">Tasks</h3>
            <!--For each task in agenda-->
            <table>
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Due Date</th>
                        <th>Priority</th>
                        <th>Status</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr id="existingTask{{i}}" name="rows" *ngFor="let task of agenda.Tasks; let i = index;"> <!-- [appClickedOutside]="titleFocus" (clickedOutside)="tableRowClick()"> -->
                        <td><input [(ngModel)]="task.title"></td> <!--(focus)="inFocus('title')"-->
                        <td><input type="date" [(ngModel)]="task.dueDate"></td>
                        <td>
                            <select [(ngModel)]="task.priority">
                                <option value="" disabled selected>Priority</option>
                                <option *ngFor="let p of priorityOptions">{{ p.name }}</option>
                            </select> 
                        </td>
                        <td>
                            <select [(ngModel)]="task.status">
                                <option *ngFor="let s of taskStatusOptions">{{ s.name }}</option>
                            </select>    
                        </td>
                        <td>
                            <button type="button" (click)="openDetails(i, in)">&#x2631;</button> <!--261A 2631 27B5-->
                        </td>
                        <!-- <td>{{task.title}}</td>
                        <td>{{task.dueDate}}</td>
                        <td>{{task.priority}}</td>
                        <td>{{task.status}}</td> -->
                        <!-- <td>{{task.description}}</td> -->
                        <!-- <td>
                            <li *ngFor="let c of task.comments">
                                {{c.comment_text}}
                            </li>
                        </td> -->
                    </tr>
                </tbody>
            </table>
            
            <!--Create new task button-->
            <form [formGroup]="newTaskForm">
                <div id="taskInputs" *ngIf="agenda.wantNewTask" appClickedOutside (clickedOutside)="createTask(agenda.name)">
                    <input type="text" id="taskName" placeholder="Title" formControlName="newTitle">
                    <div id="taskInfo">
                        <input id="taskDate" type="date" placeholder="Due Date" formControlName="newDate">
                        <select id="taskPrior"  formControlName="newPriority">
                            <option value="" disabled selected>Priority</option>
                            <option placeholder="priority" *ngFor="let p of priorityOptions">{{ p.name }}</option>
                        </select>
                    </div>
                </div>
                <div>
                    <button type="button" [hidden]="agenda.wantNewTask" id="addTask" name="addTask" (click)="displayTaskInputs(agenda.name)">Add Task</button>
                </div> 
                <br><br>
            </form>
        </li>

        <!--Create a new agenda button-->
        <form [formGroup]="newTaskForm">
            <div *ngIf="wantNewAgenda">
                <input type="text" placeholder="Agenda Name" formControlName="newAgendaName" (focusout)="createAgenda()">
            </div>
            <div>
                <button type="button" id="addAgenda" [hidden]="wantNewAgenda" (click)="displayAgendaInputs()">Add Agenda</button>
            </div>
        </form>
    </ul>
    <br><br>

    <!--Description and Comments-->
    <app-side-container #details [container_width]="600" [container_title]="container_name" [unique_id]="1">
        <h4>Description</h4>
        <textarea id="desText" [(ngModel)]="todoList[agenda_index].Tasks[task_index].description"></textarea>
        <h4>Comments</h4>
        <ul>
            <li *ngFor="let comment of todoList[agenda_index].Tasks[task_index].comments">
                <textarea [(ngModel)]="comment.comment_text"></textarea>
            </li>
            <button name="addNewComment" type="button" [hidden]="todoList[agenda_index].Tasks[task_index].wantNewComment" (click)="displayCommentInput()">New comment</button>
            <input type="text" id="commentInput" *ngIf="todoList[agenda_index].Tasks[task_index].wantNewComment" 
                    appClickedOutside (clickedOutside)="addComment()" [(ngModel)]="newComment">
        </ul>                       
    </app-side-container>    
</body>
